<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>Finalizar pedido</title>
  <style>
    :root{
      /* Cores ajustadas para ficarem como no print */
      --bg:#f6f6f6;
      --card:#ffffff;
      --text:#111827;            /* título e textos principais (quase preto) */
      --muted:#6b7280;           /* textos secundários */
      --border:#e5e7eb;          /* linhas e bordas suaves */
      --section:#f3f4f6;         /* cabeçalho das seções (cinza claro) */
      --action:#1f2937;          /* “Trocar” e botão primário (grafite) */
      --primary:#111111;         /* botão inferior */
      --pix:#18b5a6;             /* ícone do Pix (verde-água) */
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:var(--bg);
      font-family:-apple-system,BlinkMacSystemFont,"Inter","Segoe UI",Roboto,Helvetica,Arial,sans-serif;
      color:var(--text);
      line-height:1.35;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    /* Barra do topo */
    .appbar{
      position:sticky;top:0;z-index:10;
      display:flex;align-items:center;gap:.5rem;
      height:56px;padding:0 16px;
      background:#fff;border-bottom:1px solid var(--border);
    }
    .back{
      display:inline-flex;align-items:center;justify-content:center;
      width:28px;height:28px;border-radius:8px;
    }
    .appbar h1{
      font-size:20px;margin:0;font-weight:700;
    }

    /* Contêiner principal */
    .page{
      padding:12px 16px 120px; /* espaço para o botão fixo */
      max-width:760px;margin:0 auto;
    }

    /* Bloco "será entregue a" */
    .deliver-to{
      background:var(--card);border-radius:12px;padding:20px 16px;
      display:grid;grid-template-columns:1fr auto;gap:10px 12px;
      border:1px solid var(--border);
    }
    .label{color:var(--muted);font-size:16px}
    .name{font-size:24px;font-weight:800}
    .phone{font-size:16px;color:#2b2b2b}

    .btn-outline{
      align-self:start;
      padding:10px 18px;
      border:2px solid var(--action);
      color:var(--action);
      background:#fff;border-radius:12px;
      font-weight:700;font-size:18px;
      letter-spacing:.2px;
    }

    /* Cartões de seção */
    .section{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:12px;
      margin-top:14px;
      overflow:hidden;
    }
    .section-head{
      background:var(--section);
      padding:16px;
      font-size:22px;font-weight:800;
    }

    /* Cartão de endereço */
    .address-card{
      display:grid;grid-template-columns:1fr auto;gap:12px;
      padding:16px;border-top:1px solid var(--border);
      background:#fff;
    }
    .address-text{
      font-size:20px;font-weight:600;
      color:#394150;
    }
    .eta{
      display:flex;align-items:center;gap:10px;
      padding:12px 16px;border-top:1px solid var(--border);
      color:#374151;font-size:18px;font-weight:600;
      background:#fff;
    }

    /* Forma de pagamento */
    .pay-row{
      display:grid;grid-template-columns:auto 1fr auto;align-items:center;
      gap:12px;padding:16px;border-top:1px solid var(--border);
      background:#fff;
    }
    .pay-title{font-size:22px;font-weight:800;margin:0 0 4px}
    .pay-sub{font-size:18px;color:#3a3a3a}
    .pay-safe{
      display:flex;align-items:center;gap:10px;
      padding:14px 16px;border-top:1px solid var(--border);
      color:var(--muted);font-size:18px;background:#fff;
    }

    /* Cupom */
    .coupon{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:12px;
      margin-top:14px;
      padding:18px 16px;
      display:flex;justify-content:space-between;align-items:center;
      font-size:22px;font-weight:800;
    }

    /* Botão fixo inferior */
    .bottom{
      position:fixed;left:0;right:0;bottom:0;z-index:20;
      padding:12px 16px calc(12px + env(safe-area-inset-bottom));
      background:linear-gradient(180deg, rgba(246,246,246,0) 0%, rgba(246,246,246,1) 30%, rgba(246,246,246,1) 100%);
    }
    .btn-primary{
      width:100%;
      background:var(--primary);
      color:#fff;border:0;border-radius:16px;
      height:56px;font-size:22px;font-weight:800;
      display:flex;align-items:center;justify-content:center;
      letter-spacing:.2px;
      box-shadow:0 3px 8px rgba(0,0,0,.12);
    }

    /* Ícones (tamanho e alinhamento) */
    .icon{display:inline-block;vertical-align:middle}
    .icon.chevron{width:22px;height:22px}
    .icon.clock{width:22px;height:22px}
    .icon.lock{width:22px;height:22px}
    .icon.pix{width:36px;height:36px}
    .icon.caret{width:18px;height:18px;transform:rotate(180deg);} /* seta para cima */
    @media (min-width:768px){
      .page{padding-left:24px;padding-right:24px}
    }
  </style>
</head>
<body>

  <!-- AppBar -->
  <div class="appbar">
    <span class="back" aria-label="Voltar">
      <svg class="icon chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.6" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
        <path d="M15 18l-6-6 6-6"/>
      </svg>
    </span>
    <h1>Finalizar pedido</h1>
  </div>

  <main class="page">

    <!-- Bloco: entregue a -->
    <section class="deliver-to" aria-label="Dados do destinatário">
      <div class="label">Este pedido será entregue a:</div>
      <button class="btn-outline">Trocar</button>

      <div class="name">Matheus Silva</div>
      <div class="phone">(11) 9 6706-7748</div>
    </section>

    <!-- Endereço de entrega -->
    <section class="section" aria-label="Endereço de entrega">
      <div class="section-head">Endereço de entrega</div>

      <div class="address-card">
        <div class="address-text">
          Travessa Ernesto Monaci, 5,<br>
          Cidade Patriarca, São Paulo - SP<br>
          03555-045
        </div>
        <button class="btn-outline">Trocar</button>
      </div>

      <div class="eta">
        <svg class="icon clock" viewBox="0 0 24 24" fill="none" stroke="#374151" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
          <circle cx="12" cy="12" r="9"></circle>
          <path d="M12 7v5l3 2"></path>
        </svg>
        Entre 20 - 50 min
      </div>
    </section>

    <!-- Forma de pagamento -->
    <section class="section" aria-label="Forma de pagamento">
      <div class="section-head">Forma de pagamento</div>

      <div class="pay-row">
        <svg class="icon pix" viewBox="0 0 64 64" aria-hidden="true">
          <defs>
            <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0" stop-color="#1cc0b0"/>
              <stop offset="1" stop-color="#0fae9c"/>
            </linearGradient>
          </defs>
          <path fill="url(#g)" d="M21.2 10.5c3.8-3.8 10-3.8 13.8 0l18.5 18.5c3.8 3.8 3.8 10 0 13.8L35 61.3c-3.8 3.8-10 3.8-13.8 0L2.8 43c-3.8-3.8-3.8-10 0-13.8L21.2 10.5z"/>
          <path fill="#ffffff" opacity=".1" d="M27 17c2.2-2.2 5.8-2.2 8 0l12 12c2.2 2.2 2.2 5.8 0 8l-12 12c-2.2 2.2-5.8 2.2-8 0l-12-12c-2.2-2.2-2.2-5.8 0-8l12-12z"/>
        </svg>

        <div>
          <div class="pay-title">Pix</div>
          <div class="pay-sub">Pagamento com Pix online</div>
        </div>

        <button class="btn-outline">Trocar</button>
      </div>

      <div class="pay-safe">
        <svg class="icon lock" viewBox="0 0 24 24" fill="none" stroke="#9ca3af" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
          <rect x="3" y="11" width="18" height="10" rx="2"></rect>
          <path d="M7 11V8a5 5 0 0 1 10 0v3"></path>
        </svg>
        Seguro pela Tuna Pagamentos
      </div>

      <!-- Formulários -->
      <div id="pixForm" style="display:block; text-align:center; margin-top:20px;">
        <button id="btnGerarPix" class="btn-primary-modern">Gerar Chave Pix</button>
      </div>

      <div id="cardForm" style="display:none; margin-top:20px;">
        <label for="cardNumber">Número do cartão</label>
        <input type="text" id="cardNumber" placeholder="0000 0000 0000 0000">
        <label for="cardName">Nome no cartão</label>
        <input type="text" id="cardName" placeholder="Nome completo">
        <label for="cardExpiry">Validade</label>
        <input type="text" id="cardExpiry" placeholder="MM/AA">
        <label for="cardCVC">CVC</label>
        <input type="text" id="cardCVC" placeholder="123">
        <button id="confirmCard" class="btn-primary-modern">Confirmar Compra</button>
      </div>

    </section>

    <!-- Cupom -->
    <section class="coupon" aria-label="Cupom">
      <span>Cupom</span>
      <svg class="icon caret" viewBox="0 0 24 24" fill="none" stroke="#111827" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
        <path d="M6 15l6-6 6 6"/>
      </svg>
    </section>

  </main>

  <div class="bottom">
    <button class="btn-primary">Ir para o pagamento</button>
  </div>

  <!-- Modal moderno -->
  <div id="paymentModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; 
       background:rgba(0,0,0,0.6); display:flex; justify-content:center; align-items:center; z-index:100; opacity:0; transition:opacity 0.3s;">
    <div style="background:#fff; border-radius:14px; max-width:400px; width:90%; padding:24px; text-align:center; position:relative; transform:translateY(-20px); transition:transform 0.3s;">
      <h3>Escolha a forma de pagamento</h3>
      <div style="margin:20px 0; display:flex; justify-content:center; gap:10px;">
        <button id="choosePix" class="btn-primary-modern" style="flex:1;">Pix</button>
        <button id="chooseCard" class="btn-primary-modern" style="flex:1;">Cartão</button>
      </div>
      <button id="closeModal" style="position:absolute; top:12px; right:12px; font-size:22px; border:none; background:none; cursor:pointer;">×</button>
    </div>
  </div>

<style>
  .btn-primary-modern {
    background-color:#12B886;
    color:white;
    border:none;
    padding:14px 20px;
    font-size:16px;
    border-radius:8px;
    cursor:pointer;
    transition: background 0.3s;
  }
  .btn-primary-modern:hover {
    background-color:#0fae9c;
  }
  input {
    width:100%;
    padding:10px;
    margin:6px 0 14px 0;
    border-radius:6px;
    border:1px solid #ccc;
    font-size:16px;
  }
  label {
    display:block;
    margin-bottom:4px;
    font-weight:500;
  }
</style>

<script>
  const STORAGE_CART = 'sacola';
  const STORAGE_USER = 'userData';
  const STORAGE_ADDRESS = 'addressData';

  function formatBRL(v){return v.toLocaleString('pt-BR',{style:'currency',currency:'BRL'});}
  const cart = JSON.parse(localStorage.getItem(STORAGE_CART)||'[]');
  const user = JSON.parse(localStorage.getItem(STORAGE_USER)||'{}');
  const address = JSON.parse(localStorage.getItem(STORAGE_ADDRESS)||'{}');

  const deliverSection = document.querySelector('.deliver-to');
  if(deliverSection){
    deliverSection.querySelector('.name').textContent = user.name||'';
    deliverSection.querySelector('.phone').textContent = user.phone||'';
  }

  const addressCard = document.querySelector('.address-card .address-text');
  if(addressCard){
    addressCard.innerHTML = `${address.rua||''}, ${address.numero||''},<br>${address.bairro||''}, ${address.cidade||''} - ${address.estado||''}<br>${address.cep||''}`;
  }

  let subtotal=0;
  cart.forEach(item=>{
    const somaExtras=(item.extras&&item.extras.length>0)?item.extras.reduce((acc,ex)=>acc+Number(ex.preco||0)*Number(ex.quantidade||0),0):0;
    subtotal+=(Number(item.preco||0)+somaExtras)*Number(item.quantidade||1);
  });

  document.querySelectorAll('.deliver-to .btn-outline').forEach(btn=>{
    btn.addEventListener('click',()=>window.location.href='cadastro.html');
  });

  const payChangeBtn=document.querySelector('.pay-row .btn-outline');
  const modal=document.getElementById('paymentModal');
  const pixForm=document.getElementById('pixForm');
  const cardForm=document.getElementById('cardForm');
  const closeModal=document.getElementById('closeModal');

  if(payChangeBtn){
    payChangeBtn.addEventListener('click',()=>{
      modal.style.display='flex';
      setTimeout(()=>{modal.style.opacity='1'; modal.querySelector('div').style.transform='translateY(0)';},10);
    });
  }

  closeModal.addEventListener('click',()=>{
    modal.style.opacity='0';
    modal.querySelector('div').style.transform='translateY(-20px)';
    setTimeout(()=>modal.style.display='none',300);
  });

  document.getElementById('choosePix').addEventListener('click',()=>{
    pixForm.style.display='block';
    cardForm.style.display='none';
    modal.style.opacity='0';
    modal.querySelector('div').style.transform='translateY(-20px)';
    setTimeout(()=>modal.style.display='none',300);
  });

  document.getElementById('chooseCard').addEventListener('click',()=>{
    pixForm.style.display='none';
    cardForm.style.display='block';
    modal.style.opacity='0';
    modal.querySelector('div').style.transform='translateY(-20px)';
    setTimeout(()=>modal.style.display='none',300);
  });

  document.getElementById('btnGerarPix').addEventListener('click',()=>{
    alert('QR Code Pix gerado!');
    window.location.href='pagamento.html';
  });

  document.getElementById('confirmCard').addEventListener('click',()=>{
    const cardNumber=document.getElementById('cardNumber').value;
    const cardName=document.getElementById('cardName').value;
    const cardExpiry=document.getElementById('cardExpiry').value;
    const cardCVC=document.getElementById('cardCVC').value;
    if(!cardNumber||!cardName||!cardExpiry||!cardCVC){alert('Preencha todos os campos do cartão!');return;}
    alert('Compra confirmada com cartão!');
    window.location.href='pagamento.html';
  });

  document.querySelector('.bottom .btn-primary')?.addEventListener('click',()=>{
    if(cart.length===0){alert('Seu carrinho está vazio!');return;}
    alert(`Pedido de ${formatBRL(subtotal)} pronto para pagamento!`);
  });

</script>
</body>
</html>