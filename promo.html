<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Promo√ß√µes</title>
<style>
  :root{
    --bg:#f6f6f6;
    --surface:#ffffff;
    --text:#222;
    --muted:#6f6f6f;
    --primary:#222;          /* cor principal dos apps clean */
    --accent:#0bb07b;        /* verde do bot√£o */
    --border:#e8e8e8;
    --radius:12px;
    --shadow:0 2px 8px rgba(0,0,0,.06);
    --nav-h:64px;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    background:var(--bg);
    color:var(--text);
    padding-bottom:calc(var(--nav-h) + env(safe-area-inset-bottom));
  }

  /* AppBar */
  .appbar{
    position:sticky; top:0; z-index:5;
    background:var(--surface);
    border-bottom:1px solid var(--border);
    height:56px; display:flex; align-items:center; gap:10px;
    padding:0 12px env(safe-area-inset-right) 8px;
  }
  .appbar .back{
    width:36px; height:36px; display:grid; place-items:center; border-radius:18px;
  }
  .appbar h1{ font-size:18px; margin:0; font-weight:700; }

  /* Card do cupom */
  .coupon{
    background:var(--surface);
    margin:16px;
    border-radius:var(--radius);
    box-shadow:var(--shadow);
    overflow:hidden;
    border:1px solid var(--border);
  }
  .coupon__head{
    display:flex; align-items:center; justify-content:space-between;
    padding:16px;
    background:#f0f0f0;
  }
  .pill{
    background:#fff; border:1px dashed #cfcfcf; padding:6px 10px; border-radius:999px; font-weight:700;
  }
  .coupon__content{ padding:16px; display:grid; gap:12px; }
  .line{ display:flex; align-items:center; justify-content:space-between; gap:8px; }
  .label{ display:flex; align-items:center; gap:8px; color:var(--muted); font-size:14px;}
  .value{ font-weight:700; }
  .btn{
    width:100%; border:0; border-radius:10px; padding:14px 16px; font-weight:700;
    background:var(--accent); color:#fff; cursor:pointer; font-size:16px;
  }
  .btn[disabled]{ opacity:.6; cursor:not-allowed; }
  .note, .rules{
    margin:16px; color:var(--muted); font-size:14px;
  }
  .rules{
    background:var(--surface); border:1px solid var(--border);
    border-radius:10px; padding:14px;
  }

  /* Menu inferior */
  .bottom-nav {
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 65px;
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  background: #fff;
  border-top: 1px solid #e0e0e0;
  padding-bottom: env(safe-area-inset-bottom);
  z-index: 1000;
}

.nav-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  color: #666;
  font-size: 12px;
  gap: 5px;
  cursor: pointer;
}

.nav-item svg {
  width: 24px;
  height: 24px;
}

.nav-item.active {
  color: #9b51e0; /* cor prim√°ria */
  font-weight: 600;
}
</style>
</head>
<body>

  <!-- AppBar -->
  <header class="appbar">
    <button class="back" aria-label="Voltar" onclick="history.back()">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M15 18l-6-6 6-6"/>
      </svg>
    </button>
    <h1>Promo√ß√µes</h1>
  </header>

  <!-- Cupom 10% -->
  <section class="coupon" aria-label="Cupom de 10% na primeira compra">
    <div class="coupon__head">
      <strong>üéÅ Cupom de boas-vindas</strong>
      <span class="pill" id="couponCode">PRIMEIRA10</span>
    </div>

    <div class="coupon__content">
      <div class="line">
        <div class="label">
          <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 1v22M3 12h18"/></svg>
          Desconto
        </div>
        <div class="value">10% na 1¬™ compra</div>
      </div>

      <div class="line">
        <div class="label">
          <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
          Expira em
        </div>
        <div class="value" id="expiresAt">‚Äî</div>
      </div>

      <button class="btn" id="useBtn">Usar desconto</button>
      <div class="note" id="statusNote" style="display:none;"></div>
    </div>
  </section>

  <!-- Regras -->
  <div class="rules">
    <strong>Regras</strong>
    <ul style="margin:8px 0 0 18px; padding:0;">
      <li>V√°lido apenas para a <strong>primeira compra</strong> do usu√°rio.</li>
      <li>Desconto aplicado sobre o total dos produtos (antes do frete/taxas).</li>
      <li>N√£o cumulativo com outras promo√ß√µes.</li>
      <li>Utilize antes do vencimento exibido acima.</li>
    </ul>
  </div>

  <!-- Menu inferior -->
  <nav class="bottom-nav" role="navigation" aria-label="Menu inferior">
    <a class="nav-item" href="index.html" aria-label="In√≠cio">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 10.5L12 3l9 7.5V21a1 1 0 0 1-1 1h-5v-6H9v6H4a1 1 0 0 1-1-1z"/></svg>
      <span>In√≠cio</span>
    </a>
    <a class="nav-item" href="pedido.html" aria-label="Pedido">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="16" rx="2"/><path d="M7 8h10M7 12h10M7 16h6"/></svg>
      <span>Pedido</span>
    </a>
    <a class="nav-item active" href="promos.html" aria-label="Promos">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 12v7a2 2 0 0 1-2 2h-3l-3 3-3-3H6a2 2 0 0 1-2-2v-7"/><path d="M7 9l5-6 5 6"/></svg>
      <span>Promos</span>
    </a>
    <a class="nav-item" href="carrinho.html" aria-label="Carrinho">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="9" cy="20" r="1.8"/><circle cx="17" cy="20" r="1.8"/><path d="M2 3h2l2.4 12.5A2 2 0 0 0 8.3 17H18a2 2 0 0 0 2-1.6l1.6-8.4H6.2"/></svg>
      <span>Carrinho</span>
    </a>
  </nav>

<script>
/**
 * Configura√ß√£o do cupom salvo no localStorage
 * Chave: BRAONLINE_COUPON_FIRST10
 * Valor (JSON):
 * { code:"PRIMEIRA10", type:"percent", value:0.10, savedAt, expiresAt, active:true }
 */
const COUPON_KEY = 'BRAONLINE_COUPON_FIRST10';
const DEFAULT_CODE = 'PRIMEIRA10';
const PERCENT = 0.10;                 // 10%
const VALID_DAYS = 30;                 // expira em 30 dias ap√≥s salvar

const $expiresAt = document.getElementById('expiresAt');
const $useBtn     = document.getElementById('useBtn');
const $statusNote = document.getElementById('statusNote');

function formatBR(d){
  return new Intl.DateTimeFormat('pt-BR', { timeZone: 'America/Sao_Paulo' }).format(d);
}
function addDays(date, days){
  const d = new Date(date);
  d.setDate(d.getDate() + days);
  return d;
}
function readCoupon(){
  try{
    const raw = localStorage.getItem(COUPON_KEY);
    return raw ? JSON.parse(raw) : null;
  }catch(e){ return null; }
}
function saveCoupon(){
  const now = new Date();
  const expiresAt = addDays(now, VALID_DAYS);
  const payload = {
    code: DEFAULT_CODE,
    type: 'percent',
    value: PERCENT,
    savedAt: now.toISOString(),
    expiresAt: expiresAt.toISOString(),
    active: true
  };
  localStorage.setItem(COUPON_KEY, JSON.stringify(payload));
  return payload;
}
function isExpired(iso){
  return new Date(iso).getTime() < Date.now();
}
function updateUI(){
  const c = readCoupon();
  if(c){
    $expiresAt.textContent = isExpired(c.expiresAt) ? 'Expirado' : formatBR(new Date(c.expiresAt));
    if(c.active && !isExpired(c.expiresAt)){
      $useBtn.textContent = 'Cupom salvo';
      $useBtn.disabled = true;
      $statusNote.style.display = 'block';
      $statusNote.textContent = '‚úÖ Seu cupom de 10% foi salvo. Ele ser√° aplicado automaticamente na finaliza√ß√£o da compra.';
    }else{
      $useBtn.textContent = 'Usar desconto';
      $useBtn.disabled = isExpired(c.expiresAt);
      $statusNote.style.display = 'block';
      $statusNote.textContent = isExpired(c.expiresAt) ? '‚ö†Ô∏è Este cupom expirou.' : '';
    }
  }else{
    // ainda n√£o salvo: mostra validade estimada (30 dias ap√≥s salvar)
    $expiresAt.textContent = formatBR(addDays(new Date(), VALID_DAYS));
    $useBtn.textContent = 'Usar desconto';
    $useBtn.disabled = false;
    $statusNote.style.display = 'none';
  }
}
$useBtn.addEventListener('click', () => {
  const saved = saveCoupon();
  $expiresAt.textContent = formatBR(new Date(saved.expiresAt));
  updateUI();
  // feedback r√°pido
  if (navigator.vibrate) navigator.vibrate(10);
});

/* Inicializa√ß√£o */
updateUI();

/* ==========================
 * Como aplicar no checkout (exemplo):
 * const c = JSON.parse(localStorage.getItem('BRAONLINE_COUPON_FIRST10'));
 * if(c && c.active && !isExpired(c.expiresAt)) {
 *    const subtotal = totalProdutos; // antes de frete/taxas
 *    const desconto = subtotal * c.value;
 *    const totalFinal = subtotal - desconto + frete + taxas;
 *    // Exibir o desconto e o c√≥digo no resumo
 * }
 * ========================== */
// Controle do menu inferior
const navItems = document.querySelectorAll(".bottom-nav .nav-item");

navItems.forEach(item => {
  item.addEventListener("click", () => {
    navItems.forEach(i => i.classList.remove("active"));
    item.classList.add("active");

    // Redirecionamento opcional baseado no data-link
    const link = item.getAttribute("data-link");
    switch(link) {
      case "home": window.location.href = "index.html"; break;
      case "orders": window.location.href = "pedidos.html"; break;
      case "promos": window.location.href = "promos.html"; break;
      case "cart": window.location.href = "carrinho.html"; break;
    }
  });
});
</script>
</body>
</html>